---
title: git工程实战
date: 2018-01-18 10:17:55
categories: 工具
tags: git
---
## 本笔记记录git在项目开发中完整的实践过程，方便以后忘记时查看

* 首先将要开发的项目主分支clone到本地

```shell
git clone http://gitlab.khweb.com/ths-khweb/khh5-basic.git
```

* 将远程项目clone到本地后，我们查看到的是主分支，如果我们要对其中一个远程分支进行开发话，首先要看见远程所有分支

```shell
git branch -a
```

然后切换到远程目标分支，并创建本地分支

```shell
git checkout -b khh5_taipingyang origin/khh5_taipingyang
```

* 以后所有的开发就在本地khh5_taipingyang分支中进行。当要将本地分支推送远程时，我们为了不影响其他开发人员也有可能在开发这个远程分支，所以我们要推送到自己新建的远程分支khh5_taipingyang_zly

```shell
git add .
git commit -m "test"
git push origin/khh5_taipingyang_zly
```

这样我们就新建了一个自己的分支。当后面开发完成后对代码review后可以将远程自己的分支与原分支进行合并,并删除自己的分支

```shell
git push origin/khh5_taipingyang
git push origin :khh5_taipingyang_zly
```

* 如果你需要在本地对两个分支进行开发，就要使用git的分支应用。git下分支的应用是很方便的一个功能，但是有一个问题，如果我在分支A有工作尚未完成，想要跳到分支B，如果不注意，可能搞乱你的工作。

首先说，如果你的分支分支A工作区和缓存区是干净的（即你在A分支commit之后再没做任何更改），你随便往别的分支跳都不会有影响的。但是如果你在A分支下有未完成的工作，即你用git status看显示有没有add或者commit的内容，你往B分支checkout的时候，会把你在A分支下的工作带过去，如图：

![本地切换分支](https://jackiedark.github.io/img/projects/branch_status.jpg)

在命令$git checkout B之后显示的A A1 和A A2意思即为提醒使用者，有未提交的工作也一起跳转到分支B上啦（前面的大写A意味着A1，A2文件是新建且已经git add的文件；如果是大写M则意味着A1，A2文件为内容有更改的原有文件；D则意味着是删除了A1，A2文件）。这个时候你如果在B分支上进行其他工作而不编辑A1，A2文件，目前来说是没问题的。然而，一旦你在B分支上完成了某项工作，运行了commit命令，A1，A2文件之前的更改也会在A分支上进行提交，而git的规矩是，在那个分支上进行的提交，就算哪个分支上的工作。

也就是说，一旦你把A分支上尚未完成的工作带到了B分支上并在B分支上顺利提交，那么你本来希望是在A分支上进行的工作，则会被提交到本地库中B分支上，该部分工作在A分支下用git log命令查看不到但是在B分支下则可以查看到。这在实际的工作中会导致你的两个分支乱掉或者出现提交冲突。不是不能补救，但是会很麻烦，所以要尽量避免。

那么怎么避免呢？事实上，在比较旧的版本的git下，你在分支A下有未完成的工作的情形下，是无法跳转到分支B下的，这就很好的避免了后续的尴尬情况，不过目前版本的git是允许你带着未完成工作进行跳转的，所以你可以通过以下手段来避免这种情况下搞乱你的工作：

1.跳转分支之前git status一下查看是不是有没有add和commit的工作，如果有，可以的话，就都提交掉。（事实上尚未add的工作带到了新分支下如果不继续对该文件进行处理，带过去也是没有影响的，大不了跳回来再带回来嘛，反正木有add过的内容在新分支下commit也不会把这部分工作提交。） 

2.如果确实有尚未add和commit的工作，但是并未完成不方便进行提交，可以利用git stash进行现场保留，然后跳转。（git stash的用法也是一块比较重要的内容，这里暂不详细介绍了，可以直接百度其用法~） 

3.如果1.2你都没有做，很不小心地带着未commit的工作跳转到了另一分支下，跳转之后的提示可以让你意识到你把先前分支的工作带过来了，不做任何修改直接再跳回去就好（就又带回去了），然后进行1或2步中所说。